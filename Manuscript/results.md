# Results {-}

\begin{figure}[!htb]
\centering
\makebox[\textwidth][c]{\includegraphics[width=1.3\textwidth]{Figures/pipeline3.png}}%
\caption{Illustration of a mouse brain template generation workflow and 
related template-based applications demonstrating the utility of different 
ANTsX tools.  After imaging acquisition of the study population, various 
preprocessing steps are applied to the imaging data such as bias correction,
denoising, and brain extraction as dictated by the needs of the study 
protocol.  Not shown is the possibility of template symmetrization by 
contralaterally flipping the image data associated with each specimen.  
In the case of the DevCCF, applications include gene expression mapping 
and the associated velocity flow model for pseudo-template generation.}
\label{fig:pipeline}
\end{figure}

Recently, the developmental common coordinate framework (DevCCF) was introduced
to the mouse brain research community as a public resource [@Kronman:2023aa].
These symmetric atlases, comprising both multimodal image data and
anatomical segmentations defined by developmental ontology, span the mouse
embryonic days (E) 11.5, E13.5, E15.5, E18.5 and postnatal day (P) 4, P14, and
P56 with Allen CCFv3 integration with the P56 template.  Modalities include at
least four MRI contrasts and light sheet flourescence miscroscopy (LSFM) per
developmental stage.  Gene expression and other cell type data were mapped to
the corresponding developmental time point to guide the associated anatomical
parcellations. In addition to conventional preprocessing (e.g., bias field
correction, brain extraction) difficulties for the various mapping tasks
included tissue distortion, missing slices, and acquisition artifacts. We
illustrate the utility of the ANTsX ecosystem in providing solutions for these
issues in constructing the DevCCF.  In addition, we also demonstrate ANTsX
functionality in the generation of a single diffeomorphic transformation model
[@Joshi:2000aa] between developmental stages where mappings between any two
continuous time points within the temporal span of the E11.5 and P56 atlases is
determined by integration of the governing time-varying velocity field
[@Christensen:1996aa].  Such transformations permit the possibility of "pseudo"
templates generated between available developmental stages, which we also
demonstrate.

<!-- \begin{landscape}
\begin{figure}[t]
    \centering
    \begin{minipage}{9in}
        \includegraphics[width=8.5in]{Figures/pipeline.pdf}
        \caption{}
       \label{fig:convergence}
   \end{minipage}
    \end{figure}
\end{landscape} -->



\begin{figure}[!htb]
\centering
\includegraphics[width=0.7\textwidth]{Figures/SimplifiedAnnotations.pdf}
\caption{}
\label{fig:simplifiedannotations}
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[width=0.99\textwidth]{Figures/convergence.pdf}
\caption{Convergence of the optimization of the velocity field for describing the 
transformation through the developmental stages from E11.5 through P56.}
\label{fig:convergence}
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[width=0.99\textwidth]{Figures/warpedP56Volumes.pdf}
\caption{Warped P56.}
\label{fig:warpedP56}
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[width=0.99\textwidth]{Figures/CrossWarp.pdf}
\caption{Mid-sagittal visualization of the effects of the transformation model in
warping every developmental stage to the time point of every other developmental
stage.  The original images are located along the diagonal.  Columns correspond
to the warped original image whereas the rows represent the reference space to which
each image is warped.}
\label{fig:crosswarp}
\end{figure}

\begin{figure}[!htb]
\centering
\includegraphics[width=0.99\textwidth]{Figures/pseudo_template.pdf}
\caption{Illustration of the use of the velocity flow model for creating pseudo-templates
at continuous time points not represented in one of the existing developmental stages.
For example, FA templates at time point P10.3 and P20 can be generated by warping the 
existing temporally adjacent developmental templates to the target time point and using 
those images in the ANTsX template building process.}
\label{fig:pseudo}
\end{figure}


